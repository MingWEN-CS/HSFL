169d168
<                     final double si = secondaryBidiagonal[i];
172,181c171,175
<                     ei1 = eData[i + 1];
<                     for (int j = 0; j < p; ++j) {
<                         wi[j] = (mi * ei0[j] + si * ei1[j]) / singularValues[j];
<                     }
<                 }
<                 
<                 final double lastMain = mainBidiagonal[p - 1];
<                 final double[] wr1  = wData[p - 1];
<                 for (int j = 0; j < p; ++j) {
<                     wr1[j] = ei1[j] * lastMain / singularValues[j];
---
>                         ei1 = eData[i + 1];
>                         final double si = secondaryBidiagonal[i];
>                         for (int j = 0; j < p; ++j) {
>                             wi[j] = (mi * ei0[j] + si * ei1[j]) / singularValues[j];
>                         }
182a177,180
>                         for (int j = 0; j < p; ++j) {
>                             wData[p - 1][j] = ei1[j] * mainBidiagonal[p - 1] / singularValues[j];
>                         }
> 
256d253
<                     final double si = secondaryBidiagonal[i];
259,268c256,260
<                     ei1 = eData[i + 1];
<                     for (int j = 0; j < p; ++j) {
<                         wi[j] = (mi * ei0[j] + si * ei1[j]) / singularValues[j];
<                     }
<                 }
<                 
<                 final double lastMain = mainBidiagonal[p - 1];
<                 final double[] wr1  = wData[p - 1];
<                 for (int j = 0; j < p; ++j) {
<                     wr1[j] = ei1[j] * lastMain / singularValues[j];
---
>                         ei1 = eData[i + 1];
>                         final double si = secondaryBidiagonal[i];
>                         for (int j = 0; j < p; ++j) {
>                             wi[j] = (mi * ei0[j] + si * ei1[j]) / singularValues[j];
>                         }
269a262,264
>                         for (int j = 0; j < p; ++j) {
>                             wData[p - 1][j] = ei1[j] * mainBidiagonal[p - 1] / singularValues[j];
>                         }
