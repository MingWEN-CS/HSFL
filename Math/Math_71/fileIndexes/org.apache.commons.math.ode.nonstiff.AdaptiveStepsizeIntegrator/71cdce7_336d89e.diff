258c258,259
<   protected double filterStep(final double h, final boolean acceptSmall)
---
> 
>   protected double filterStep(final double h, final boolean forward, final boolean acceptSmall)
264c265
<               filteredH = (filteredH < 0) ? -minStep : minStep;
---
>               filteredH = forward ? minStep : -minStep;
277c278
<       } else if (h < -maxStep) {
---
>       } else if (filteredH < -maxStep) {
