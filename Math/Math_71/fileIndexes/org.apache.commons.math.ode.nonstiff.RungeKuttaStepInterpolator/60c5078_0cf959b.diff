136,138c136,140
<     out.writeInt(yDotK.length);
<     for (int k = 0; k < yDotK.length; ++k) {
<       for (int i = 0; i < currentState.length; ++i) {
---
>     final int n = (currentState == null) ? -1 : currentState.length;
>     final int kMax = (yDotK == null) ? -1 : yDotK.length;
>     out.writeInt(kMax);
>     for (int k = 0; k < kMax; ++k) {
>       for (int i = 0; i < n; ++i) {
155a158
>     final int n = (currentState == null) ? -1 : currentState.length;
157c160
<     yDotK = new double[kMax][];
---
>     yDotK = (kMax < 0) ? null : new double[kMax][];
159,160c162,163
<       yDotK[k] = new double[currentState.length];
<       for (int i = 0; i < currentState.length; ++i) {
---
>       yDotK[k] = (n < 0) ? null : new double[n];
>       for (int i = 0; i < n; ++i) {
167,171c170,178
<     try {
<       
<       setInterpolatedTime(t);
<     } catch (DerivativeException e) {
<       throw MathRuntimeException.createIOException(e);
---
>     if (currentState != null) {
>         try {
>             
>             setInterpolatedTime(t);
>         } catch (DerivativeException e) {
>             throw MathRuntimeException.createIOException(e);
>         }
>     } else {
>         interpolatedTime = t;
