36d35
< import org.apache.commons.math.util.FastMath;
315c314
<             if (MathUtils.equals(entry, 1d, getEpsilon(entry)) && (row == null)) {
---
>             if (MathUtils.equals(entry, 1d, maxUlps) && (row == null)) {
317c316
<             } else if (!MathUtils.equals(entry, 0d, getEpsilon(entry))) {
---
>             } else if (!MathUtils.equals(entry, 0d, maxUlps)) {
339c338
<             if (MathUtils.compareTo(entry, 0d, getEpsilon(entry)) > 0) {
---
>             if (MathUtils.compareTo(entry, 0d, maxUlps) > 0) {
618,626d616
<     }
<     
<     
< 
< 
< 
< 
<     private double getEpsilon(double value) {
<         return FastMath.ulp(value) * (double) maxUlps;
