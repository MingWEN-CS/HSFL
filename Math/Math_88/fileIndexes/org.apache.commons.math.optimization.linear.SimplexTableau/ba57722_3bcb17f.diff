25a26
> import java.util.HashSet;
26a28
> import java.util.Set;
324c326,328
<         double mostNegative = getDecisionVariableValue(getOriginalNumDecisionVariables());
---
>         Integer basicRow =
>             getBasicRow(getNumObjectiveFunctions() + getOriginalNumDecisionVariables());
>         double mostNegative = basicRow == null ? 0 : getEntry(basicRow, getRhsOffset());
326,327c330,342
<             coefficients[i] =
<                 getDecisionVariableValue(i) - (restrictToNonNegative ? 0 : mostNegative); 
---
>             basicRow = getBasicRow(getNumObjectiveFunctions() + i);
>                 
>                 
>                 coefficients[i] =
>                     (basicRow == null ? 0 : getEntry(basicRow, getRhsOffset())) -
>                     (restrictToNonNegative ? 0 : mostNegative);
>             if (basicRow != null) {
>                 for (int j = getNumObjectiveFunctions(); j < getNumObjectiveFunctions() + i; j++) {
>                     if (tableau.getEntry(basicRow, j) == 1) {
>                          coefficients[i] = 0;
>                     }
>                 }
>             }
331,354d345
< 
<     
< 
< 
< 
< 
< 
< 
< 
<     protected double getDecisionVariableValue(final int decisionVariable) {
<       int col = getNumObjectiveFunctions() + decisionVariable;  
<       Integer basicRow = getBasicRow(col);
<       if (basicRow == null) {
<           return 0;
<       }
<       
<       
<       for (int i = getNumObjectiveFunctions(); i < col; i++) {
<           if (tableau.getEntry(basicRow, i) == 1) {
<               return 0;
<           }
<       }
<       return getEntry(basicRow, getRhsOffset()); 
<   }
