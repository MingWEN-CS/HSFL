325c325,329
<         
---
> 
>         if (k > n / 2) {
>             return binomialCoefficientLog(n, n - k);
>         }
> 
332,333c336,337
<         for (int i = k + 1; i <= n; i++) {
<             logSum += Math.log((double)i);
---
>         for (int i = n - k + 1; i <= n; i++) {
>             logSum += Math.log((double) i);
337,338c341,342
<         for (int i = 2; i <= n - k; i++) {
<             logSum -= Math.log((double)i);
---
>         for (int i = 2; i <= k; i++) {
>             logSum -= Math.log((double) i);
