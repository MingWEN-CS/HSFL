268c268,270
<         return  (f.value(lower) * f.value(upper) < 0);
---
>     	double f1 = f.value(lower);
>     	double f2 = f.value(upper);
>     	return ((f1 > 0 && f2 < 0) || (f1 < 0 && f2 > 0));
