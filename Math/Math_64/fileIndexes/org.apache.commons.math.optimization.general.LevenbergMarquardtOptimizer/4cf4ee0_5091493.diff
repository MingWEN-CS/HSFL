270d269
< 
280d278
< 
360d357
< 
423a421,423
> 
>                     
>                     
435,441c435,441
< 
<                 
<                 if (checker != null) {
<                     
<                     if (checker.converged(getIterations(), previous, current)) {
<                         return current;
<                     }
---
>                 if (checker==null) {
>                 	if (((Math.abs(actRed) <= costRelativeTolerance) &&
>                         (preRed <= costRelativeTolerance) &&
>                         (ratio <= 2.0)) ||
>                        (delta <= parRelativeTolerance * xNorm)) {
>                        return current;
>                    }
443,447c443
<                     
<                     if (((Math.abs(actRed) <= costRelativeTolerance) &&
<                          (preRed <= costRelativeTolerance) &&
<                          (ratio <= 2.0)) ||
<                         (delta <= parRelativeTolerance * xNorm)) {
---
>                     if (checker.converged(getIterations(), previous, current)) {
451d446
< 
