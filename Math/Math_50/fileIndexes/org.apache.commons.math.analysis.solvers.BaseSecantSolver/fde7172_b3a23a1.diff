174d173
<                 
177,178d175
<                 x1 = x;
<                 f1 = fx;
181,182c178,179
<                 
<                 if (method == Method.ILLINOIS) {
---
>                 switch (method) {
>                 case ILLINOIS:
184,185c181,182
<                 }
<                 if (method == Method.PEGASUS) {
---
>                     break;
>                 case PEGASUS:
186a184,197
>                     break;
>                 case REGULA_FALSI:
>                     if (x == x1) {
>                         final double delta = FastMath.max(rtol * FastMath.abs(x1),
>                                                           atol);
>                         
>                         
>                         x0 = 0.5 * (x0 + x1 - delta);
>                         f0 = computeObjectiveValue(x0);
>                     }
>                     break;
>                 default:
>                     
>                     throw new MathInternalError();
188,189d198
<                 x1 = x;
<                 f1 = fx;
190a200,202
>             
>             x1 = x;
>             f1 = fx;
