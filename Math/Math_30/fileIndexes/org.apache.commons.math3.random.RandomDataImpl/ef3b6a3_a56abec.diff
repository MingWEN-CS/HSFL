170c170,171
<         return lower + (int) (rand.nextDouble() * (upper - lower + 1));
---
>         double r = rand.nextDouble();
>         return (int)((r * upper) + ((1.0 - r) * lower) + r);
187c188,189
<         return lower + (long) (rand.nextDouble() * (upper - lower + 1));
---
>         double r = rand.nextDouble();
>         return (long)((r * upper) + ((1.0 - r) * lower) + r);
