69c69
<     protected final double scalAbsoluteTolerance;
---
>     protected double scalAbsoluteTolerance;
72c72
<     protected final double scalRelativeTolerance;
---
>     protected double scalRelativeTolerance;
75c75
<     protected final double[] vecAbsoluteTolerance;
---
>     protected double[] vecAbsoluteTolerance;
78c78
<     protected final double[] vecRelativeTolerance;
---
>     protected double[] vecRelativeTolerance;
87c87
<     private final double minStep;
---
>     private double minStep;
90c90
<     private final double maxStep;
---
>     private double maxStep;
110,119c110
< 
<     this.minStep     = FastMath.abs(minStep);
<     this.maxStep     = FastMath.abs(maxStep);
<     this.initialStep = -1.0;
< 
<     this.scalAbsoluteTolerance = scalAbsoluteTolerance;
<     this.scalRelativeTolerance = scalRelativeTolerance;
<     this.vecAbsoluteTolerance  = null;
<     this.vecRelativeTolerance  = null;
< 
---
>     setStepSizeControl(minStep, maxStep, scalAbsoluteTolerance, scalRelativeTolerance);
141a133,134
>     setStepSizeControl(minStep, maxStep, vecAbsoluteTolerance, vecRelativeTolerance);
>     resetInternalState();
143,150c136
<     this.minStep     = minStep;
<     this.maxStep     = maxStep;
<     this.initialStep = -1.0;
< 
<     this.scalAbsoluteTolerance = 0;
<     this.scalRelativeTolerance = 0;
<     this.vecAbsoluteTolerance  = vecAbsoluteTolerance.clone();
<     this.vecRelativeTolerance  = vecRelativeTolerance.clone();
---
>   }
152c138,192
<     resetInternalState();
---
>   
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
>   public void setStepSizeControl(final double minimalStep, final double maximalStep,
>                                  final double absoluteTolerance,
>                                  final double relativeTolerance) {
> 
>       minStep     = FastMath.abs(minimalStep);
>       maxStep     = FastMath.abs(maximalStep);
>       initialStep = -1;
> 
>       scalAbsoluteTolerance = absoluteTolerance;
>       scalRelativeTolerance = relativeTolerance;
>       vecAbsoluteTolerance  = null;
>       vecRelativeTolerance  = null;
> 
>   }
> 
>   
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
>   public void setStepSizeControl(final double minimalStep, final double maximalStep,
>                                  final double[] absoluteTolerance,
>                                  final double[] relativeTolerance) {
> 
>       minStep     = FastMath.abs(minimalStep);
>       maxStep     = FastMath.abs(maximalStep);
>       initialStep = -1;
> 
>       scalAbsoluteTolerance = 0;
>       scalRelativeTolerance = 0;
>       vecAbsoluteTolerance  = absoluteTolerance.clone();
>       vecRelativeTolerance  = relativeTolerance.clone();
