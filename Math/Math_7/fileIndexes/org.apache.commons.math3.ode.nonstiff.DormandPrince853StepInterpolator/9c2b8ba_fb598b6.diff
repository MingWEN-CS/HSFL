262,263c262,264
<     out.writeInt(currentState.length);
<     for (int i = 0; i < currentState.length; ++i) {
---
>     final int dimension = (currentState == null) ? -1 : currentState.length;
>     out.writeInt(dimension);
>     for (int i = 0; i < dimension; ++i) {
282,284c283,285
<     yDotKLast[0] = new double[dimension];
<     yDotKLast[1] = new double[dimension];
<     yDotKLast[2] = new double[dimension];
---
>     yDotKLast[0] = (dimension < 0) ? null : new double[dimension];
>     yDotKLast[1] = (dimension < 0) ? null : new double[dimension];
>     yDotKLast[2] = (dimension < 0) ? null : new double[dimension];
