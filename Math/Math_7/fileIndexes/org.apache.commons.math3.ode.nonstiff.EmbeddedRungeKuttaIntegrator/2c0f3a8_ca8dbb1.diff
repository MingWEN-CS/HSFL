26a27
> import org.apache.commons.math.util.FastMath;
248c249
<                 scale[i] = scalAbsoluteTolerance + scalRelativeTolerance * Math.abs(y[i]);
---
>                 scale[i] = scalAbsoluteTolerance + scalRelativeTolerance * FastMath.abs(y[i]);
252c253
<                 scale[i] = vecAbsoluteTolerance[i] + vecRelativeTolerance[i] * Math.abs(y[i]);
---
>                 scale[i] = vecAbsoluteTolerance[i] + vecRelativeTolerance[i] * FastMath.abs(y[i]);
294c295
<               if (Math.abs(dt) <= Math.ulp(stepStart)) {
---
>               if (FastMath.abs(dt) <= FastMath.ulp(stepStart)) {
317,318c318,319
<               Math.min(maxGrowth,
<                        Math.max(minReduction, safety * Math.pow(error, exp)));
---
>               FastMath.min(maxGrowth,
>                        FastMath.max(minReduction, safety * FastMath.pow(error, exp)));
355,357c356,358
<         final double factor = Math.min(maxGrowth,
<                                        Math.max(minReduction,
<                                                 safety * Math.pow(error, exp)));
---
>         final double factor = FastMath.min(maxGrowth,
>                                        FastMath.max(minReduction,
>                                                 safety * FastMath.pow(error, exp)));
