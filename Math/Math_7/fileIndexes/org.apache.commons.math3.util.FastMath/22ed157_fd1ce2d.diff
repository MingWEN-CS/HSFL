80a81,82
>     
>     private static final double LOG_MAX_VALUE = StrictMath.log(Double.MAX_VALUE);
392,397c394,409
<       if (x > 20.0) {
<           return exp(x)/2.0;
<       }
< 
<       if (x < -20) {
<           return exp(-x)/2.0;
---
>       if (x > 20) {
>           if (x >= LOG_MAX_VALUE) {
>               
>               final double t = exp(0.5 * x);
>               return (0.5 * t) * t;
>           } else {
>               return 0.5 * exp(x);
>           }
>       } else if (x < -20) {
>           if (x <= -LOG_MAX_VALUE) {
>               
>               final double t = exp(-0.5 * x);
>               return (0.5 * t) * t;
>           } else {
>               return 0.5 * exp(-x);
>           }
400c412
<       double hiPrec[] = new double[2];
---
>       final double hiPrec[] = new double[2];
452,457c464,479
<       if (x > 20.0) {
<           return exp(x)/2.0;
<       }
< 
<       if (x < -20) {
<           return -exp(-x)/2.0;
---
>       if (x > 20) {
>           if (x >= LOG_MAX_VALUE) {
>               
>               final double t = exp(0.5 * x);
>               return (0.5 * t) * t;
>           } else {
>               return 0.5 * exp(x);
>           }
>       } else if (x < -20) {
>           if (x <= -LOG_MAX_VALUE) {
>               
>               final double t = exp(-0.5 * x);
>               return (-0.5 * t) * t;
>           } else {
>               return -0.5 * exp(-x);
>           }
