20d19
< import org.apache.commons.math3.exception.MathInternalError;
21a21
> import org.apache.commons.math3.exception.MathInternalError;
86c86,91
<         final double[] residualsWeights = getNonCorrelatedWeight();
---
>         final RealMatrix weightMatrix = getWeight();
>         
>         final double[] residualsWeights = new double[nR];
>         for (int i = 0; i < nR; i++) {
>             residualsWeights[i] = weightMatrix.getEntry(i, i);
>         }
