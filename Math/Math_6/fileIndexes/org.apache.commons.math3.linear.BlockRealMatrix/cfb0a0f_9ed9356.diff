223c223,224
<         for (int iBlock = 0, blockIndex = 0; iBlock < blockRows; ++iBlock) {
---
>         int blockIndex = 0;
>         for (int iBlock = 0; iBlock < blockRows; ++iBlock) {
227c228
<             for (int jBlock = 0; jBlock < blockColumns; ++jBlock, ++blockIndex) {
---
>             for (int jBlock = 0; jBlock < blockColumns; ++jBlock) {
237c238,239
<                 for (int p = pStart, index = 0; p < pEnd; ++p, index += jWidth) {
---
>                 int index = 0;
>                 for (int p = pStart; p < pEnd; ++p) {
238a241
>                     index += jWidth;
240a244,245
>                 ++blockIndex;
> 
266c271,272
<         for (int iBlock = 0, blockIndex = 0; iBlock < blockRows; ++iBlock) {
---
>         int blockIndex = 0;
>         for (int iBlock = 0; iBlock < blockRows; ++iBlock) {
270c276
<             for (int jBlock = 0; jBlock < blockColumns; ++jBlock, ++blockIndex) {
---
>             for (int jBlock = 0; jBlock < blockColumns; ++jBlock) {
274a281
>                 ++blockIndex;
330,331c337,339
<                     for (int p = pStart, k = 0; p < pEnd; ++p) {
<                         for (int q = qStart; q < qEnd; ++q, ++k) {
---
>                     int k = 0;
>                     for (int p = pStart; p < pEnd; ++p) {
>                         for (int q = qStart; q < qEnd; ++q) {
332a341
>                             ++k;
401,402c410,412
<                     for (int p = pStart, k = 0; p < pEnd; ++p) {
<                         for (int q = qStart; q < qEnd; ++q, ++k) {
---
>                     int k = 0;
>                     for (int p = pStart; p < pEnd; ++p) {
>                         for (int q = qStart; q < qEnd; ++q) {
403a414
>                             ++k;
520c531,532
<                         for (int p = pStart, k = 0; p < pEnd; ++p) {
---
>                         int k = 0;
>                         for (int p = pStart; p < pEnd; ++p) {
525c537,538
<                                 for (int l = lStart, r = rStart; l < lEnd; ++l, ++r) {
---
>                                 int r = rStart;
>                                 for (int l = lStart; l < lEnd; ++l) {
526a540
>                                     ++r;
528c542,543
<                                 outBlock[k++] += sum;
---
>                                 outBlock[k] += sum;
>                                 ++k;
580c595,596
<                     for (int p = pStart, k = 0; p < pEnd; ++p) {
---
>                     int k = 0;
>                     for (int p = pStart; p < pEnd; ++p) {
599c615,616
<                             outBlock[k++] += sum;
---
>                             outBlock[k] += sum;
>                             ++k;
702c719,720
<         for (int iBlock = 0, pBlock = blockStartRow; iBlock < out.blockRows; ++iBlock, ++pBlock) {
---
>         int pBlock = blockStartRow;
>         for (int iBlock = 0; iBlock < out.blockRows; ++iBlock) {
704c722,723
<             for (int jBlock = 0, qBlock = blockStartColumn; jBlock < out.blockColumns; ++jBlock, ++qBlock) {
---
>             int qBlock = blockStartColumn;
>             for (int jBlock = 0; jBlock < out.blockColumns; ++jBlock) {
768a788,789
>                 ++qBlock;
> 
769a791,793
> 
>             ++pBlock;
> 
1297c1321,1322
<                 for (int p = pStart, k = 0; p < pEnd; ++p) {
---
>                 int k = 0;
>                 for (int p = pStart; p < pEnd; ++p) {
1299,1300c1324,1328
<                     for (int q = qStart, l = p - pStart; q < qEnd; ++q, l+= lInc) {
<                         outBlock[k++] = tBlock[l];
---
>                     int l = p - pStart;
>                     for (int q = qStart; q < qEnd; ++q) {
>                         outBlock[k] = tBlock[l];
>                         ++k;
>                         l+= lInc;
1346c1374,1375
<                 for (int p = pStart, k = 0; p < pEnd; ++p) {
---
>                 int k = 0;
>                 for (int p = pStart; p < pEnd; ++p) {
1432c1461,1462
<                     for (int q = qStart, k = (p - pStart) * jWidth; q < qEnd; ++q, ++k) {
---
>                     int k = (p - pStart) * jWidth;
>                     for (int q = qStart; q < qEnd; ++q) {
1433a1464
>                         ++k;
1455c1486,1487
<                     for (int q = qStart, k = (p - pStart) * jWidth; q < qEnd; ++q, ++k) {
---
>                     int k = (p - pStart) * jWidth;
>                     for (int q = qStart; q < qEnd; ++q) {
1456a1489
>                         ++k;
1483c1516,1517
<                     for (int q = qStart, k = (p - p0) * jWidth + qStart - q0; q < qEnd; ++q, ++k) {
---
>                     int k = (p - p0) * jWidth + qStart - q0;
>                     for (int q = qStart; q < qEnd; ++q) {
1484a1519
>                         ++k;
1511c1546,1547
<                     for (int q = qStart, k = (p - p0) * jWidth + qStart - q0; q < qEnd; ++q, ++k) {
---
>                     int k = (p - p0) * jWidth + qStart - q0;
>                     for (int q = qStart; q < qEnd; ++q) {
1512a1549
>                         ++k;
1525c1562,1563
<         for (int iBlock = 0, blockIndex = 0; iBlock < blockRows; ++iBlock) {
---
>         int blockIndex = 0;
>         for (int iBlock = 0; iBlock < blockRows; ++iBlock) {
1528c1566
<             for (int jBlock = 0; jBlock < blockColumns; ++jBlock, ++blockIndex) {
---
>             for (int jBlock = 0; jBlock < blockColumns; ++jBlock) {
1532,1533c1570,1572
<                 for (int p = pStart, k = 0; p < pEnd; ++p) {
<                     for (int q = qStart; q < qEnd; ++q, ++k) {
---
>                 int k = 0;
>                 for (int p = pStart; p < pEnd; ++p) {
>                     for (int q = qStart; q < qEnd; ++q) {
1534a1574
>                         ++k;
1536a1577
>                 ++blockIndex;
1547c1588,1589
<         for (int iBlock = 0, blockIndex = 0; iBlock < blockRows; ++iBlock) {
---
>         int blockIndex = 0;
>         for (int iBlock = 0; iBlock < blockRows; ++iBlock) {
1550c1592
<             for (int jBlock = 0; jBlock < blockColumns; ++jBlock, ++blockIndex) {
---
>             for (int jBlock = 0; jBlock < blockColumns; ++jBlock) {
1554,1555c1596,1598
<                 for (int p = pStart, k = 0; p < pEnd; ++p) {
<                     for (int q = qStart; q < qEnd; ++q, ++k) {
---
>                 int k = 0;
>                 for (int p = pStart; p < pEnd; ++p) {
>                     for (int q = qStart; q < qEnd; ++q) {
1556a1600
>                         ++k;
1558a1603
>                 ++blockIndex;
1583c1628,1629
<                     for (int q = qStart, k = (p - p0) * jWidth + qStart - q0; q < qEnd; ++q, ++k) {
---
>                     int k = (p - p0) * jWidth + qStart - q0;
>                     for (int q = qStart; q < qEnd; ++q) {
1584a1631
>                         ++k;
1611c1658,1659
<                     for (int q = qStart, k = (p - p0) * jWidth + qStart - q0; q < qEnd; ++q, ++k) {
---
>                     int k = (p - p0) * jWidth + qStart - q0;
>                     for (int q = qStart; q < qEnd; ++q) {
1612a1661
>                         ++k;
