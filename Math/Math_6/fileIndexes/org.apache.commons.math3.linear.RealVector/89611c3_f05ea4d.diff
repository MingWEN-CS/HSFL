645c645,647
<         RealMatrix product;
---
>         final int m = this.getDimension();
>         final int n = v.getDimension();
>         final RealMatrix product;
647,648c649
<             product = new OpenMapRealMatrix(this.getDimension(),
<                                             v.getDimension());
---
>             product = new OpenMapRealMatrix(m, n);
650,651c651
<             product = new Array2DRowRealMatrix(this.getDimension(),
<                                                v.getDimension());
---
>             product = new Array2DRowRealMatrix(m, n);
653,660c653,655
<         Iterator<Entry> thisIt = sparseIterator();
<         while (thisIt.hasNext()) {
<             final Entry thisE = thisIt.next();
<             Iterator<Entry> otherIt = v.sparseIterator();
<             while (otherIt.hasNext()) {
<                 final Entry otherE = otherIt.next();
<                 product.setEntry(thisE.getIndex(), otherE.getIndex(),
<                                  thisE.getValue() * otherE.getValue());
---
>         for (int i = 0; i < m; i++) {
>             for (int j = 0; j < n; j++) {
>                 product.setEntry(i, j, this.getEntry(i) * v.getEntry(j));
663d657
< 
665d658
< 
