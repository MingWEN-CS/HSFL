766d765
<             checkVectorDimensions(v);
768,770c767,770
<             final RealMatrix out = MatrixUtils.createRealMatrix(m, m);
<             for (int i = 0; i < data.length; i++) {
<                 for (int j = 0; j < data.length; j++) {
---
>             final int n = v.getDimension();
>             final RealMatrix out = MatrixUtils.createRealMatrix(m, n);
>             for (int i = 0; i < m; i++) {
>                 for (int j = 0; j < n; j++) {
792d791
<         checkVectorDimensions(v.length);
794,796c793,796
<         final RealMatrix out = MatrixUtils.createRealMatrix(m, m);
<         for (int i = 0; i < data.length; i++) {
<             for (int j = 0; j < data.length; j++) {
---
>         final int n = v.length;
>         final RealMatrix out = MatrixUtils.createRealMatrix(m, n);
>         for (int i = 0; i < m; i++) {
>             for (int j = 0; j < n; j++) {
