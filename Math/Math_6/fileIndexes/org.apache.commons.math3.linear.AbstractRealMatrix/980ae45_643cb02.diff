609,624c609,619
< 
<         final int nRows = getRowDimension();
<         final int nCols = getColumnDimension();
<         if (v.getDimension() != nCols) {
<             throw MathRuntimeException.createIllegalArgumentException("vector length mismatch:" +
<                                                                       " got {0} but expected {1}",
<                                                                       new Object[] {
<                                                                           v.getDimension(), nCols
<                                                                       });
<         }
< 
<         final double[] out = new double[nRows];
<         for (int row = 0; row < nRows; ++row) {
<             double sum = 0;
<             for (int i = 0; i < nCols; ++i) {
<                 sum += getEntry(row, i) * v.getEntry(i);
---
>         try {
>             return new RealVectorImpl(operate(((RealVectorImpl) v).getDataRef()), false);
>         } catch (ClassCastException cce) {
>             final int nRows = getRowDimension();
>             final int nCols = getColumnDimension();
>             if (v.getDimension() != nCols) {
>                 throw MathRuntimeException.createIllegalArgumentException("vector length mismatch:" +
>                                                                           " got {0} but expected {1}",
>                                                                           new Object[] {
>                                                                               v.getDimension(), nCols
>                                                                           });
626,627d620
<             out[row] = sum;
<         }
629c622,629
<         return new RealVectorImpl(out, false);
---
>             final double[] out = new double[nRows];
>             for (int row = 0; row < nRows; ++row) {
>                 double sum = 0;
>                 for (int i = 0; i < nCols; ++i) {
>                     sum += getEntry(row, i) * v.getEntry(i);
>                 }
>                 out[row] = sum;
>             }
630a631,632
>             return new RealVectorImpl(out, false);
>         }
662a665,677
>         try {
>             return new RealVectorImpl(preMultiply(((RealVectorImpl) v).getDataRef()), false);
>         } catch (ClassCastException cce) {
> 
>             final int nRows = getRowDimension();
>             final int nCols = getColumnDimension();
>             if (v.getDimension() != nRows) {
>                 throw MathRuntimeException.createIllegalArgumentException("vector length mismatch:" +
>                                                                           " got {0} but expected {1}",
>                                                                           new Object[] {
>                                                                               v.getDimension(), nRows
>                                                                           });
>             }
664,678c679,685
<         final int nRows = getRowDimension();
<         final int nCols = getColumnDimension();
<         if (v.getDimension() != nRows) {
<             throw MathRuntimeException.createIllegalArgumentException("vector length mismatch:" +
<                                                                       " got {0} but expected {1}",
<                                                                       new Object[] {
<                                                                           v.getDimension(), nRows
<                                                                       });
<         }
< 
<         final double[] out = new double[nCols];
<         for (int col = 0; col < nCols; ++col) {
<             double sum = 0;
<             for (int i = 0; i < nRows; ++i) {
<                 sum += getEntry(i, col) * v.getEntry(i);
---
>             final double[] out = new double[nCols];
>             for (int col = 0; col < nCols; ++col) {
>                 double sum = 0;
>                 for (int i = 0; i < nRows; ++i) {
>                     sum += getEntry(i, col) * v.getEntry(i);
>                 }
>                 out[col] = sum;
680,681d686
<             out[col] = sum;
<         }
683c688
<         return new RealVectorImpl(out);
---
>             return new RealVectorImpl(out);
684a690
>         }
