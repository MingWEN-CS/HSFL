118c118,119
<         isSymmetric = isSymmetric(matrix, false);
---
>         final double symTol = 10 * matrix.getRowDimension() * matrix.getColumnDimension() * Precision.EPSILON;
>         isSymmetric = MatrixUtils.isSymmetric(matrix, symTol);
182,212d182
<     }
< 
<     
< 
< 
< 
< 
< 
< 
< 
< 
< 
<     private boolean isSymmetric(final RealMatrix matrix,
<                                 boolean raiseException) {
<         final int rows = matrix.getRowDimension();
<         final int columns = matrix.getColumnDimension();
<         final double eps = 10 * rows * columns * Precision.EPSILON;
<         for (int i = 0; i < rows; ++i) {
<             for (int j = i + 1; j < columns; ++j) {
<                 final double mij = matrix.getEntry(i, j);
<                 final double mji = matrix.getEntry(j, i);
<                 if (FastMath.abs(mij - mji) >
<                     (FastMath.max(FastMath.abs(mij), FastMath.abs(mji)) * eps)) {
<                     if (raiseException) {
<                         throw new NonSymmetricMatrixException(i, j, eps);
<                     }
<                     return false;
<                 }
<             }
<         }
<         return true;
