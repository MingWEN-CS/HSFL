634,635c634,635
<         checkVectorDimensions(v.length);
<         RealMatrix res = new OpenMapRealMatrix(virtualSize, virtualSize);
---
>         final int n = v.length;
>         RealMatrix res = new OpenMapRealMatrix(virtualSize, n);
641c641
<             for (int col = 0; col < virtualSize; col++) {
---
>             for (int col = 0; col < n; col++) {
