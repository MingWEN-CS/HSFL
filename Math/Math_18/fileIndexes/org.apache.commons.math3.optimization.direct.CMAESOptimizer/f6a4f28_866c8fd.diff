588,589c588,589
<             final double range =  (boundaries == null) ? 1.0 : boundaries[1][i] - boundaries[0][i];
<             sigmaArray[i][0]   = ((inputSigma == null) ? 0.3 : inputSigma[i]) / range;
---
>             final double range = (boundaries == null) ? 1.0 : boundaries[1][i] - boundaries[0][i];
>             sigmaArray[i][0] = ((inputSigma == null) ? 0.3 : inputSigma[i]) / range;
932c932
<                 res[i] = (x[i] - boundaries[0][i]) / diff;
---
>                 res[i] = x[i] / diff;
958c958
<                 res[i] = diff * x[i] + boundaries[0][i];
---
>                 res[i] = diff * x[i];
988a989,992
> 
>             final double[] bLoEnc = encode(boundaries[0]);
>             final double[] bHiEnc = encode(boundaries[1]);
> 
990c994
<                 if (x[i] < 0) {
---
>                 if (x[i] < bLoEnc[i]) {
993c997
<                 if (x[i] > 1.0) {
---
>                 if (x[i] > bHiEnc[i]) {
