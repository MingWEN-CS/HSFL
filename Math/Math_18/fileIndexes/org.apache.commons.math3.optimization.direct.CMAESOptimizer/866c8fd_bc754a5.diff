932c932
<                 res[i] = x[i] / diff;
---
>                 res[i] = (x[i] - boundaries[0][i]) / diff;
958c958
<                 res[i] = diff * x[i];
---
>                 res[i] = diff * x[i] + boundaries[0][i];
990,991d989
<             final double[] bLoEnc = encode(boundaries[0]);
<             final double[] bHiEnc = encode(boundaries[1]);
994c992
<                 if (x[i] < bLoEnc[i]) {
---
>                 if (x[i] < 0) {
997c995
<                 if (x[i] > bHiEnc[i]) {
---
>                 if (x[i] > 1.0) {
