125c125
<         } else if (x > (a + 1.0) / (a + b + 1.0)) {
---
>         } else if (x > (a + 1.0) / (a + b + 2.0)) {
132,146c132,139
<                     switch (n) {
<                         case 1 :
<                             ret = 1.0;
<                             break;
<                         default :
<                             if (n % 2 == 0) { 
<                                 m = (n - 2.0) / 2.0;
<                                 ret = -((a + m) * (a + b + m) * x) /
<                                     ((a + (2 * m)) * (a + (2 * m) + 1.0));
<                             } else {
<                                 m = (n - 1.0) / 2.0;
<                                 ret = (m * (b - m) * x) /
<                                     ((a + (2 * m) - 1) * (a + (2 * m)));
<                             }
<                             break;
---
>                     if (n % 2 == 0) { 
>                         m = n / 2.0;
>                         ret = (m * (b - m) * x) /
>                             ((a + (2 * m) - 1) * (a + (2 * m)));
>                     } else {
>                         m = (n - 1.0) / 2.0;
>                         ret = -((a + m) * (a + b + m) * x) /
>                                 ((a + (2 * m)) * (a + (2 * m) + 1.0));
152,161c145
<                     double ret;
<                     switch (n) {
<                         case 0 :
<                             ret = 0.0;
<                             break;
<                         default :
<                             ret = 1.0;
<                             break;
<                     }
<                     return ret;
---
>                     return 1.0;
166c150
<                 fraction.evaluate(x, epsilon, maxIterations);
---
>                 1.0 / fraction.evaluate(x, epsilon, maxIterations);
