146,147c146,147
<         if (Double.isNaN(x) || Double.isNaN(a) || Double.isNaN(b) || (x < 0)
<                 || (x > 1) || (a <= 0.0) || (b <= 0.0)) {
---
>         if (Double.isNaN(x) || Double.isNaN(a) || Double.isNaN(b) || (x < 0) ||
>             (x > 1) || (a <= 0.0) || (b <= 0.0)) {
161,164c161,162
<                                 ret =
<                                     -((a + m) * (a + b + m) * x)
<                                         / ((a + (2 * m))
<                                         * (a + (2 * m) + 1.0));
---
>                                 ret = -((a + m) * (a + b + m) * x) /
>                                     ((a + (2 * m)) * (a + (2 * m) + 1.0));
167,169c165,166
<                                 ret =
<                                     (m * (b - m) * x)
<                                         / ((a + (2 * m) - 1) * (a + (2 * m)));
---
>                                 ret = (m * (b - m) * x) /
>                                     ((a + (2 * m) - 1) * (a + (2 * m)));
189,191c186,188
<             ret = Math.exp((a * Math.log(x)) + (b * Math.log(1.0 - x))
<                 - Math.log(a) - logBeta(a, b, epsilon, maxIterations))
<                 * fraction.evaluate(x, epsilon, maxIterations);
---
>             ret = Math.exp((a * Math.log(x)) + (b * Math.log(1.0 - x)) -
>                 Math.log(a) - logBeta(a, b, epsilon, maxIterations)) *
>                 fraction.evaluate(x, epsilon, maxIterations);
233,234c230,231
<             ret = Gamma.logGamma(a) + Gamma.logGamma(b)
<                 - Gamma.logGamma(a + b);
---
>             ret = Gamma.logGamma(a) + Gamma.logGamma(b) -
>                 Gamma.logGamma(a + b);
