1372a1373,1374
> 
> 
1377,1378c1379,1380
<          final int N = x.length;
<          final int M = h.length;
---
>          final int lenX = x.length;
>          final int lenH = h.length;
1380c1382
<          if (N == 0 || M == 0) {
---
>          if (lenX == 0 || lenH == 0) {
1385c1387
<          final int totalLength = N + M - 1;
---
>          final int totalLength = lenX + lenH - 1;
1391,1395c1393,1396
<              for (int k = 0; k < M; k++) {
<                  final int j = n - k;
<                  if ((j > -1) && (j < N) ) {
<                      yn = yn + x[j] * h[k];
<                  }
---
>              int k = FastMath.max(0, n + 1 - lenX);
>              int j = n - k;
>              while (k < lenH && j >= 0) {
>                  yn += x[j--] * h[k++];
