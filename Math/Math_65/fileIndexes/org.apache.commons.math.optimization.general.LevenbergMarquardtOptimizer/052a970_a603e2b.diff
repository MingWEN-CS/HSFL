23a24
> import org.apache.commons.math.util.MathUtils;
143a145,148
>     private double qrRankingThreshold;
> 
>     
> 
170a176
>         setQRRankingThreshold(MathUtils.SAFE_MIN);
219a226,238
> 
> 
> 
> 
> 
> 
> 
> 
>     public void setQRRankingThreshold(final double qrRankingThreshold) {
>         this.qrRankingThreshold = qrRankingThreshold;
>     }
> 
>     
808c827
<             if (ak2 == 0) {
---
>             if (ak2 <= qrRankingThreshold) {
