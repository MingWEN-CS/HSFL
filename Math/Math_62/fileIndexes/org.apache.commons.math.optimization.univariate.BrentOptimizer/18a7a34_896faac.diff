19a20
> import org.apache.commons.math.util.MathUtils;
222c223,224
<                     if (fu <= fw || w == x) {
---
>                     if (fu <= fw ||
>                         MathUtils.equals(w, x)) {
227c229,231
<                     } else if (fu <= fv || v == x || v == w) {
---
>                     } else if (fu <= fv ||
>                                MathUtils.equals(v, x) ||
>                                MathUtils.equals(v, w)) {
