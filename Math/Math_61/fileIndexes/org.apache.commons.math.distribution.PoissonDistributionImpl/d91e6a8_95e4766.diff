14,16d13
< 
< 
< 
30a28
> 
52d49
< 
66d62
< 
89d84
< 
93,94c88
<                   "the Poisson mean must be positive ({0})",
<                   p);
---
>                     "the Poisson mean must be positive ({0})", p);
106a101
> 
107a103
>         double ret;
109c105,112
<             return 0;
---
>             ret = 0.0;
>         } else if (x == 0) {
>             ret = Math.exp(-mean);
>         } else {
>             ret = Math.exp(-SaddlePointExpansion.getStirlingError(x)
>                     - SaddlePointExpansion.getDeviancePart(x, mean))
>                     / Math.sqrt(2.0 * Math.PI * x); 
>                                                     
111,112c114
<         return Math.pow(getMean(), x) /
<             MathUtils.factorialDouble(x) * Math.exp(-mean);
---
>         return ret;
122a125
> 
131,132c134,135
<         return Gamma.regularizedGammaQ((double)x + 1, mean,
<                 1E-12, Integer.MAX_VALUE);
---
>         return Gamma.regularizedGammaQ((double) x + 1, mean, 1E-12,
>                 Integer.MAX_VALUE);
146a150,152
> 
> 
> 
178a185
> 
