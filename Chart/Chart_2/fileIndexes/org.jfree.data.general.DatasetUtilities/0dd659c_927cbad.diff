125a126
> 
980c981
<             Number lvalue, uvalue;
---
>             Number value, lvalue, uvalue;
982a984,990
>                     value = icd.getValue(row, column);
>                     double v;
>                     if ((value != null)
>                             && !Double.isNaN(v = value.doubleValue())) {
>                         minimum = Math.min(v, minimum);
>                         maximum = Math.max(v, maximum);
>                     }
984,986c992,995
<                     uvalue = icd.getEndValue(row, column);
<                     if (lvalue != null && !Double.isNaN(lvalue.doubleValue())) {
<                         minimum = Math.min(minimum, lvalue.doubleValue());
---
>                     if (lvalue != null
>                             && !Double.isNaN(v = lvalue.doubleValue())) {
>                         minimum = Math.min(v, minimum);
>                         maximum = Math.max(v, maximum);
988,989c997,1001
<                     if (uvalue != null && !Double.isNaN(uvalue.doubleValue())) {
<                         maximum = Math.max(maximum, uvalue.doubleValue());
---
>                     uvalue = icd.getEndValue(row, column);
>                     if (uvalue != null 
>                             && !Double.isNaN(v = uvalue.doubleValue())) {
>                         minimum = Math.min(v, minimum);
>                         maximum = Math.max(v, maximum);
