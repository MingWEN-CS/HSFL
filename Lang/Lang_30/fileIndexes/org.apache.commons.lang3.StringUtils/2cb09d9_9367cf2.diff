927a928,933
>         if (array == null) {
>             return null;
>         }
>         if (separator == null) {
>             separator = "";
>         }
935c941
<                 : arraySize * (array[0].toString().length() 
---
>                 : arraySize * ((array[0] == null ? 16 : array[0].toString().length()) 
943,944c949,952
<          }
<             buf.append(array[i]);
---
>             }
>             if (array[i] != null) {
>                 buf.append(array[i]);
>             }
959a968,970
>         if (array == null) {
>             return null;
>         }
961c972
<         int bufSize = (arraySize == 0 ? 0 : (array[0].toString().length() + 1) * arraySize);
---
>         int bufSize = (arraySize == 0 ? 0 : ((array[0] == null ? 16 : array[0].toString().length()) + 1) * arraySize);
968c979,981
<             buf.append(array[i]);
---
>             if (array[i] != null) {
>                 buf.append(array[i]);
>             }
984a998,1000
>         if (iterator == null) {
>             return null;
>         }
987c1003,1006
<             buf.append(iterator.next());
---
>             Object obj = iterator.next();
>             if (obj != null) {
>                 buf.append(obj);
>             }
1005a1025,1027
>         if (iterator == null) {
>             return null;
>         }
1008c1030,1033
<             buf.append(iterator.next());
---
>             Object obj = iterator.next();
>             if (obj != null) {
>                 buf.append(obj);
>             }
1031a1057,1065
> 
> 
> 
> 
> 
> 
> 
> 
> 
1046a1081,1089
> 
> 
> 
> 
> 
> 
> 
> 
> 
1062a1106,1117
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
1064c1119
<         if (text == null || repl == null || with == null || repl.length() == 0) {
---
>         if (text == null || repl == null || with == null || repl.length() == 0 || max == 0) {
1091a1147,1156
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
1092a1158,1163
>         if (text == null) {
>             return null;
>         }
>         if (overlay == null) {
>             overlay = "";
>         }
1113a1185,1196
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
1114a1198,1203
>         if (str == null) {
>             return null;
>         }
>         if (size < 0) {
>             size = 0;
>         }
1136a1226,1240
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
1137a1242,1250
>         if (str == null) {
>             return null;
>         }
>         if (padStr == null || padStr.length() == 0) {
>             throw new IllegalArgumentException("Pad String must not be null or empty");
>         }
>         if (size < 0) {
>             size = 0;
>         }
1163d1275
< 
1165c1277
<         if (str.length() == 0) {
---
>         if (str == null || str.length() == 0) {
1205d1316
< 
1207c1318
<         if (str.length() == 0) {
---
>         if (str == null || str.length() == 0) {
1327d1437
< 
1329,1330c1439,1440
<         if ("".equals(str)) {
<             return "";
---
>         if (str == null) {
>             return null;
1332c1442,1443
<         if (str.length() == 1) {
---
>         int strLen = str.length();
>         if (strLen < 2) {
1335c1446
<         int lastIdx = str.length() - 1;
---
>         int lastIdx = strLen - 1;
1384d1494
< 
1399d1508
< 
1400a1510,1512
>         if (str == null || sep == null || str.length() == 0 || sep.length() == 0) {
>             return str;
>         }
1420d1531
< 
1421a1533,1538
>         if (str == null || str.length() == 0) {
>             return str;
>         }
>         if (sep == null || sep.length() == 0) {
>             return "";
>         }
1443d1559
< 
1444a1561,1566
>         if (str == null || str.length() == 0) {
>             return str;
>         }
>         if (sep == null || sep.length() == 0) {
>             return "";
>         }
1464d1585
< 
1465a1587,1589
>         if (str == null || sep == null || str.length() == 0 || sep.length() == 0) {
>             return str;
>         }
1618a1743,1745
>         if (str == null) {
>             return null;
>         }
1648a1776,1778
>         if (str == null) {
>             return null;
>         }
1682a1813,1818
>         if (str == null) {
>             return null;
>         }
>         if (padStr == null || padStr.length() == 0) {
>             throw new IllegalArgumentException("Pad String must not be null or empty");
>         }
1712a1849,1851
>         if (str == null) {
>             return null;
>         }
1742a1882,1884
>         if (str == null) {
>             return null;
>         }
1777,1778c1919,1927
<         if (padStr.length() == 1 && size - str.length() <= PAD_LIMIT)
<            return leftPad(str, size, padStr.charAt(0));
---
>         if (str == null) {
>             return null;
>         }
>         if (padStr == null || padStr.length() == 0) {
>             throw new IllegalArgumentException("Pad String must not be null or empty");
>         }
>         if (padStr.length() == 1 && size - str.length() <= PAD_LIMIT) {
>             return leftPad(str, size, padStr.charAt(0));
>         }
2144d2292
< 
2146,2149c2294
<         if (sub.equals("")) {
<             return 0;
<         }
<         if (str == null) {
---
>         if (str == null || str.length() == 0 || sub == null || sub.length() == 0) {
2389c2534
<         if( (valid == null) || (str == null) ) {
---
>         if ( (valid == null) || (str == null) ) {
2392c2537
<         if(str.length() == 0) {
---
>         if (str.length() == 0) {
2395c2540
<         if(valid.length == 0) {
---
>         if (valid.length == 0) {
2409d2553
< 
2411c2555
<          if(searchChars == null) {
---
>          if (searchChars == null) {
2425d2568
< 
2584,2585c2727,2730
<     public static String abbreviate(String s, int maxWidth) {
<         return abbreviate(s, 0, maxWidth);
---
> 
> 
>     public static String abbreviate(String str, int maxWidth) {
>         return abbreviate(str, 0, maxWidth);
2602,2603c2747,2753
<     public static String abbreviate(String s, int offset, int maxWidth) {
<         if (maxWidth < 4)
---
> 
> 
>     public static String abbreviate(String str, int offset, int maxWidth) {
>         if (str == null) {
>             return null;
>         }
>         if (maxWidth < 4) {
2605,2613c2755,2768
<         if (s.length() <= maxWidth)
<             return s;
<         if (offset > s.length())
<             offset = s.length();
<         if ((s.length() - offset) < (maxWidth-3))
<             offset = s.length() - (maxWidth-3);
<         if (offset <= 4)
<             return s.substring(0, maxWidth-3) + "...";
<         if (maxWidth < 7)
---
>         }
>         if (str.length() <= maxWidth) {
>             return str;
>         }
>         if (offset > str.length()) {
>             offset = str.length();
>         }
>         if ((str.length() - offset) < (maxWidth - 3)) {
>             offset = str.length() - (maxWidth - 3);
>         }
>         if (offset <= 4) {
>             return str.substring(0, maxWidth - 3) + "...";
>         }
>         if (maxWidth < 7) {
2615,2617c2770,2774
<         if ((offset + (maxWidth-3)) < s.length())
<             return "..." + abbreviate(s.substring(offset), maxWidth-3);
<         return "..." + s.substring(s.length() - (maxWidth-3));
---
>         }
>         if ((offset + (maxWidth - 3)) < str.length()) {
>             return "..." + abbreviate(str.substring(offset), maxWidth - 3);
>         }
>         return "..." + str.substring(str.length() - (maxWidth - 3));
2634,2635c2791,2800
<     public static String difference(String s1, String s2) {
<         int at = differenceAt(s1, s2);
---
> 
> 
>     public static String difference(String str1, String str2) {
>         if (str1 == null) {
>             return str2;
>         }
>         if (str2 == null) {
>             return str1;
>         }
>         int at = differenceAt(str1, str2);
2639c2804
<         return s2.substring(at);
---
>         return str2.substring(at);
2651c2816,2824
<     public static int differenceAt(String s1, String s2) {
---
> 
> 
>     public static int differenceAt(String str1, String str2) {
>         if (str1 == str2) {
>             return -1;
>         }
>         if (str1 == null || str2 == null) {
>             return 0;
>         }
2653,2654c2826,2827
<         for (i=0; i<s1.length() && i<s2.length(); ++i) {
<             if (s1.charAt(i) != s2.charAt(i)) {
---
>         for (i = 0; i < str1.length() && i < str2.length(); ++i) {
>             if (str1.charAt(i) != str2.charAt(i)) {
2658c2831
<         if (i<s2.length() || i<s1.length()) {
---
>         if (i < str2.length() || i < str1.length()) {
2682a2856,2858
>         if (s == null || t == null) {
>             throw new IllegalArgumentException("Strings must not be null");
>         }
