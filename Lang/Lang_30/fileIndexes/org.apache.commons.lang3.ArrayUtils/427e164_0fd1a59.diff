3193a3194,3455
>         Class clss = null;
>         if(array != null) {
>             clss = array.getClass().getComponentType();
>         } else
>         if(element != null) {
>             clss = element.getClass();
>         } else {
>             return new Object[] { null };
>         }
>         return (Object[]) add( (Object) array, index, element, clss );
>     }
>     
>     
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
>     public static boolean[] add(boolean[] array, int index, boolean element) {
>         return (boolean[]) add( (Object) array, index, new Boolean(element), Boolean.TYPE );
>     }
>     
>     
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
>     public static char[] add(char[] array, int index, char element) {
>         return (char[]) add( (Object) array, index, new Character(element), Character.TYPE );
>     }
>     
>     
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
>     public static byte[] add(byte[] array, int index, byte element) {
>         return (byte[]) add( (Object) array, index, new Byte(element), Byte.TYPE );
>     }
>     
>     
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
>     public static short[] add(short[] array, int index, short element) {
>         return (short[]) add( (Object) array, index, new Short(element), Short.TYPE );
>     }
>     
>     
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
>     public static int[] add(int[] array, int index, int element) {
>         return (int[]) add( (Object) array, index, new Integer(element), Integer.TYPE );
>     }
>     
>     
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
>     public static long[] add(long[] array, int index, long element) {
>         return (long[]) add( (Object) array, index, new Long(element), Long.TYPE );
>     }
>     
>     
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
>     public static float[] add(float[] array, int index, float element) {
>         return (float[]) add( (Object) array, index, new Float(element), Float.TYPE );
>     }
>     
>     
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
>     public static double[] add(double[] array, int index, double element) {
>         return (double[]) add( (Object) array, index, new Double(element), Double.TYPE );
>     }
>     
>     private static Object add(Object array, int index, Object element, Class clss) {
3198c3460
<             Object joinedArray = Array.newInstance(element != null ? element.getClass() : Object.class, 1);
---
>             Object joinedArray = Array.newInstance(clss, 1);
3200c3462
<             return (Object[]) joinedArray;
---
>             return joinedArray;
3202c3464
<         int length = array.length;
---
>         int length = Array.getLength(array);
3206c3468
<         Object result = Array.newInstance(array.getClass().getComponentType(), length + 1);
---
>         Object result = Array.newInstance(clss, length + 1);
3212c3474
<         return (Object[]) result;
---
>         return result;
