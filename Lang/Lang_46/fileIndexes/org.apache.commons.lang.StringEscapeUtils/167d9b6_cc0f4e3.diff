43c43,45
<     private static final char[] CSV_SEARCH_CHARS = new char[] {',', '"', CharUtils.CR, CharUtils.LF};
---
>     private static final char CSV_DELIMITER = ',';
>     private static final char CSV_QUOTE = '"';
>     private static final char[] CSV_SEARCH_CHARS = new char[] {CSV_DELIMITER, CSV_QUOTE, CharUtils.CR, CharUtils.LF};
721,728c723,730
<         StringBuffer buffer = new StringBuffer(str.length() + 10);
<         buffer.append('"');
<         for (int i = 0; i < str.length(); i++) {
<             char c = str.charAt(i);
<             if (c == '"') {
<                 buffer.append('"'); 
<             }
<             buffer.append(c);
---
>         try {
>             StringWriter writer = new StringWriter();
>             escapeCsv(writer, str);
>             return writer.toString();
>         } catch (IOException ioe) {
>             
>             ioe.printStackTrace();
>             return null;
730,731d731
<         buffer.append('"');
<         return buffer.toString();
764c764
<         out.write('"');
---
>         out.write(CSV_QUOTE);
767,768c767,768
<             if (c == '"') {
<                 out.write('"'); 
---
>             if (c == CSV_QUOTE) {
>                 out.write(CSV_QUOTE); 
772c772
<         out.write('"');
---
>         out.write(CSV_QUOTE);
