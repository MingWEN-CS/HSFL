1386c1386
<         return lastIndexOf(ch, 0);
---
>         return lastIndexOf(ch, size - 1);
1401d1400
<         char[] thisBuf = buf;
1403c1402
<             if (thisBuf[i] == ch) {
---
>             if (buf[i] == ch) {
1419c1418
<         return lastIndexOf(str, size);
---
>         return lastIndexOf(str, size - 1);
1442c1441
<             char[] thisBuf = buf;
---
> 
1444c1443
<             for (int i = startIndex - strLen; i >= 0; i--) {
---
>             for (int i = startIndex - strLen + 1; i >= 0; i--) {
1446c1445
<                     if (str.charAt(j) != thisBuf[i + j]) {
---
>                     if (str.charAt(j) != buf[i + j]) {
