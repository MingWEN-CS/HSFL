3293,3294c3293,3294
<         int bufSize = (endIndex - startIndex);
<         if (bufSize <= 0) {
---
>         int noOfItems = (endIndex - startIndex);
>         if (noOfItems <= 0) {
3297,3299c3297,3298
< 
<         bufSize *= ((array[startIndex] == null ? 16 : array[startIndex].toString().length()) + 1);
<         StringBuilder buf = new StringBuilder(bufSize);
---
>         
>         StringBuilder buf = new StringBuilder((array[startIndex] == null ? 16 : array[startIndex].toString().length()) + 1);
3312d3310
< 
3380,3381c3378,3379
<         int bufSize = (endIndex - startIndex);
<         if (bufSize <= 0) {
---
>         int noOfItems = (endIndex - startIndex);
>         if (noOfItems <= 0) {
3385,3388c3383
<         bufSize *= ((array[startIndex] == null ? 16 : array[startIndex].toString().length())
<                         + separator.length());
< 
<         StringBuilder buf = new StringBuilder(bufSize);
---
>         StringBuilder buf = new StringBuilder((array[startIndex] == null ? 16 : array[startIndex].toString().length()) + separator.length());
