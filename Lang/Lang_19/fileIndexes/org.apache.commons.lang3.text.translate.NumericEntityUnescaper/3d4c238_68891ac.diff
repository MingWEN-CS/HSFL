40c40
<         if(input.charAt(index) == '&' && index < seqEnd - 2 && input.charAt(index + 1) == '#') {
---
>         if(input.charAt(index) == '&' && index < seqEnd - 1 && input.charAt(index + 1) == '#') {
50,52d49
<                 if(start == seqEnd) {
<                     return 0;
<                 }
57,59c54
<             while(end < seqEnd && ( (input.charAt(end) >= '0' && input.charAt(end) <= '9') ||
<                                     (input.charAt(end) >= 'a' && input.charAt(end) <= 'f') ||
<                                     (input.charAt(end) >= 'A' && input.charAt(end) <= 'F') ) )
---
>             while(input.charAt(end) != ';') 
84d78
<             boolean semiNext = (end != seqEnd) && (input.charAt(end) == ';');
86c80
<             return 2 + (end - start) + (isHex ? 1 : 0) + (semiNext ? 1 : 0);
---
>             return 2 + (end - start) + (isHex ? 1 : 0) + 1;
