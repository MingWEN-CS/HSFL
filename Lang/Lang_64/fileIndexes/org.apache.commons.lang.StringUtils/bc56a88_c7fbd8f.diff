2442,2443c2442,2443
<         if (str == null) {
<             return null;
---
>         if (str == null || str.length() == 0) {
>             return str;
2446c2446,2447
<         StringBuffer buffer = new StringBuffer(sz);
---
>         char[] chs = new char[sz];
>         int count = 0;
2449c2450
<                 buffer.append(str.charAt(i));
---
>                 chs[count++] = str.charAt(i);
2452c2453,2456
<         return buffer.toString();
---
>         if (count == sz) {
>             return str;
>         }
>         return new String(chs, 0, count);
