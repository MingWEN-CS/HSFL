349c349
<         if (NodeUtil.isName(n) && jsScope.isDeclared(n.getString(), false)) {
---
>         if (NodeUtil.isName(n) && jsScope.isDeclared(n.getString(), true)) {
374a375,387
>   }
> 
>   boolean dependsOnOuterScopeVars(String name, Node useNode) {
>     Preconditions.checkArgument(getCfg().hasNode(useNode));
>     GraphNode<Node, Branch> n = getCfg().getNode(useNode);
>     FlowState<MustDef> state = n.getAnnotation();
>     Definition def = state.getIn().reachingDef.get(jsScope.getVar(name));
>     for (Var s : def.depends) {
>       if (s.scope != jsScope) {
>         return true;
>       }
>     }
>     return false;
