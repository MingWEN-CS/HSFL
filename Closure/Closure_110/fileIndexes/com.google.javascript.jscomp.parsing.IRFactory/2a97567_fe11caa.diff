19a20
> import com.google.common.collect.Lists;
75a77,78
> import java.util.Collections;
> import java.util.List;
250a254,262
> 
> 
> 
> 
> 
> 
> 
> 
> 
516c528,535
<     int lineIndex = sourceString.lastIndexOf('\n', position);
---
>     int newlineIndex = Collections.binarySearch(newlines, position);
>     int lineIndex = -1;
>     if (newlineIndex >= 0) {
>       lineIndex = newlines.get(newlineIndex);
>     } else if (newlineIndex <= -2) {
>       lineIndex = newlines.get(-newlineIndex - 2);
>     }
> 
