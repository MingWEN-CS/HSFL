483c483,484
<         ensureTyped(t, n, getJSType(expr));
---
>         JSType exprType = getJSType(expr);
>         JSType castType = getJSType(n);
487,489c488,493
<         JSType castType = getJSType(n);
<         JSType exprType = getJSType(expr);
<         if (castType.isSubtype(exprType)) {
---
>         if (!expr.isObjectLit()) {
>           validator.expectCanCast(t, n, castType, exprType);
>         }
>         ensureTyped(t, n, castType);
> 
>         if (castType.isSubtype(exprType) || expr.isObjectLit()) {
1990a1995
>     
1993,2002d1997
<       if (info.hasType()) {
<         
<         
<         
<         
<         JSType infoType = info.getType().evaluate(t.getScope(), typeRegistry);
<         validator.expectCanCast(t, n, infoType, type);
<         type = infoType;
<       }
< 
