301a302,308
> 
>         boolean preferLineBreaks =
>             type == Token.SCRIPT ||
>             (type == Token.BLOCK &&
>                 !preserveBlock &&
>                 n.getParent() != null &&
>                 n.getParent().getType() == Token.SCRIPT);
316c323
<           if (type == Token.SCRIPT) {
---
>           if (preferLineBreaks) {
