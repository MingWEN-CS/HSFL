35,36d34
< import com.google.javascript.jscomp.deps.SortedDependencies;
< import com.google.javascript.jscomp.deps.SortedDependencies.CircularDependencyException;
749,761d746
<       if (options.processCommonJSModules) {
<         
<         modules = Lists.newArrayList(compiler.getDegenerateModuleGraph()
<             .getAllModules());
<         
<         try {
<           SortedDependencies<JSModule> sorter =
<               new SortedDependencies<JSModule>(modules);
<           modules = sorter.getDependenciesOf(modules, true);
<         } catch (CircularDependencyException e) {
<           throw Throwables.propagate(e);
<         }
<       }
823d807
<       outputModuleGraphJson();
826d809
<       outputModuleGraphJson();
1441,1461d1423
<   private void outputModuleGraphJson() throws IOException {
<     if (config.outputModuleDependencies != null &&
<         config.outputModuleDependencies != "") {
<       Writer out = fileNameToOutputWriter2(config.outputModuleDependencies);
<       printModuleGraphJsonTo(compiler.getDegenerateModuleGraph(), out);
<       out.close();
<     }
<   }
< 
<   
< 
< 
<   @VisibleForTesting
<   void printModuleGraphJsonTo(JSModuleGraph graph,
<       Appendable out) throws IOException {
<     out.append(compiler.getDegenerateModuleGraph().toJson().toString());
<   }
< 
<   
< 
< 
1981,1992d1942
<       return this;
<     }
< 
<     private String outputModuleDependencies = null;
< 
<     
< 
< 
< 
<     CommandLineConfig setOutputModuleDependencies(String
<         outputModuleDependencies) {
<       this.outputModuleDependencies = outputModuleDependencies;
