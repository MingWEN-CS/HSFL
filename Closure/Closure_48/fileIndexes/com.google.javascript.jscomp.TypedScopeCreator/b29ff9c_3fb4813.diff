92a93,94
> 
> 
1196a1199,1206
>       Scope scope = getQnameRootScope(n);
>       return scope != null && scope.isGlobal();
>     }
> 
>     
> 
> 
>     private Scope getQnameRootScope(Node n) {
1201c1211
<           return var.isGlobal();
---
>           return var.getScope();
1204c1214
<       return false;
---
>       return null;
1476a1487,1510
>       
>       
>       
>       
>       
>       
>       
>       
>       
>       
>       
>       
>       
>       
>       
>       
>       
>       
>       
>       
>       
>       
>       
>       
1512,1513c1546
<       } else if (rhsValue != null &&
<           rhsValue.isTrue()) {
---
>       } else if (rhsValue != null && rhsValue.isTrue()) {
