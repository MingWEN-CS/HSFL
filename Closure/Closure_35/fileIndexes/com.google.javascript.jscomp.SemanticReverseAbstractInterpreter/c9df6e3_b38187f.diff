422,423c422,423
<     if (rightType instanceof FunctionType) {
<       targetType = (FunctionType) rightType;
---
>     if (rightType != null && rightType.isFunctionType()) {
>       targetType = rightType.toMaybeFunctionType();
492,496c492,494
<       if (target instanceof FunctionType) {
<         FunctionType funcTarget = (FunctionType) target;
<         if (funcTarget.hasInstanceType()) {
<           return funcTarget.getInstanceType();
<         }
---
>       FunctionType funcTarget = JSType.toMaybeFunctionType(target);
>       if (funcTarget != null && funcTarget.hasInstanceType()) {
>         return funcTarget.getInstanceType();
521c519
<       FunctionType funcTarget = (FunctionType) target;
---
>       FunctionType funcTarget = target.toMaybeFunctionType();
547c545
<       FunctionType funcTarget = (FunctionType) target;
---
>       FunctionType funcTarget = target.toMaybeFunctionType();
565c563
<       FunctionType funcTarget = (FunctionType) target;
---
>       FunctionType funcTarget = target.toMaybeFunctionType();
