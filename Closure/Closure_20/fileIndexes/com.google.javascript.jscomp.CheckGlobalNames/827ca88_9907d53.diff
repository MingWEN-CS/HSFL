115,118d114
<     boolean singleGlobalParentDecl =
<         parent != null &&
<         parent.getDeclaration() != null &&
<         parent.localSets == 0;
129,138c125,150
<       } else if (ref.scope.isGlobal() &&
<           singleGlobalParentDecl &&
<           parent.getDeclaration().preOrderIndex > ref.preOrderIndex) {
<         compiler.report(
<             JSError.make(ref.source.getName(), ref.node,
<                 NAME_DEFINED_LATE_WARNING,
<                 name.getFullName(),
<                 parent.getFullName(),
<                 parent.getDeclaration().source.getName(),
<                 String.valueOf(parent.getDeclaration().node.getLineno())));
---
>       } else {
>         
>         if (ref.scope.isGlobal()) {
>           
>           
>           boolean isPrototypeGet = (ref.type == Ref.Type.PROTOTYPE_GET);
>           Name owner = isPrototypeGet ? name : parent;
>           boolean singleGlobalParentDecl =
>               owner != null &&
>               owner.getDeclaration() != null &&
>               owner.localSets == 0;
> 
>           if (singleGlobalParentDecl &&
>               owner.getDeclaration().preOrderIndex > ref.preOrderIndex) {
>             String refName = isPrototypeGet
>                 ? name.getFullName() + ".prototype"
>                 : name.getFullName();
>             compiler.report(
>                 JSError.make(ref.source.getName(), ref.node,
>                     NAME_DEFINED_LATE_WARNING,
>                     refName,
>                     owner.getFullName(),
>                     owner.getDeclaration().source.getName(),
>                     String.valueOf(owner.getDeclaration().node.getLineno())));
>           }
>         }
