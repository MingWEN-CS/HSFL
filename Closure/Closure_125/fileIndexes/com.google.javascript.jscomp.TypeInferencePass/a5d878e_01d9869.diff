40,41c40,41
<   private Scope topScope;
<   private MemoizedScopeCreator scopeCreator;
---
>   private final Scope topScope;
>   private final MemoizedScopeCreator scopeCreator;
105,107c105
<     Preconditions.checkState(scopeCreator instanceof MemoizedScopeCreator);
<     for (Scope s :
<            ((MemoizedScopeCreator) scopeCreator).getAllMemoizedScopes()) {
---
>     for (Scope s : scopeCreator.getAllMemoizedScopes()) {
