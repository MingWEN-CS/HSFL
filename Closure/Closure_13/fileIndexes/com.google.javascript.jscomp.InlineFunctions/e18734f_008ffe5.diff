538c538
<           (result == CanInlineResult.AFTER_DECOMPOSITION);
---
>           (result == CanInlineResult.AFTER_PREPARATION);
746c746
<     if (!fs.hasReferences()) {
---
>     if (!fs.hasReferences() || !fs.canInline()) {
811c811
<             decomposer.maybeDecomposeExpression(ref.callNode);
---
>             injector.maybePrepareCall(ref.callNode);
